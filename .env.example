# ================================================================
# prime-jennie Configuration
# ================================================================
# 1. Copy this file: cp .env.example .env
# 2. Fill in required values (marked with REQUIRED)
# 3. All values have sensible defaults unless noted
# ================================================================

# ─── Runtime ─────────────────────────────────────────────────────
APP_ENV=production                     # development | staging | production
APP_DEBUG=false
APP_LOG_LEVEL=INFO
APP_TIMEZONE=Asia/Seoul
TRADING_MODE=REAL                      # REAL | MOCK (모의투자)
DRY_RUN=false                          # true면 주문 미실행

# ─── Database (MariaDB) ─────────────────────────────────────────
DB_HOST=localhost
DB_PORT=3307
DB_USER=prime                          # REQUIRED
DB_PASSWORD=                           # REQUIRED (secrets.json 또는 env)
DB_NAME=prime_jennie

# ─── Redis ───────────────────────────────────────────────────────
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# ─── KIS (한국투자증권 API) ──────────────────────────────────────
# REQUIRED: 한투 Open API 발급 정보
KIS_APP_KEY=                           # REQUIRED
KIS_APP_SECRET=                        # REQUIRED
KIS_ACCOUNT_NO=                        # REQUIRED (계좌번호 8자리)
KIS_ACCOUNT_PRODUCT_CODE=01
KIS_BASE_URL=https://openapi.koreainvestment.com:9443
KIS_IS_PAPER=false                     # true=모의투자
KIS_TOKEN_FILE_PATH=/app/config/kis_token.json
KIS_GATEWAY_URL=http://kis-gateway:8080

# ─── LLM Providers ──────────────────────────────────────────────
LLM_TIER_FAST_PROVIDER=ollama          # ollama | openai | claude | gemini
LLM_TIER_REASONING_PROVIDER=deepseek_cloud  # deepseek_cloud → CloudFailoverProvider
LLM_TIER_THINKING_PROVIDER=deepseek_cloud
LLM_VLLM_LLM_URL=http://vllm-llm:8001/v1
LLM_VLLM_EMBED_URL=http://vllm-embed:8002/v1
LLM_VLLM_MAX_MODEL_LEN=4096

# LLM API Keys (at least one REASONING provider key required)
OPENROUTER_API_KEY=                    # OpenRouter (deepseek_cloud primary)
DEEPSEEK_API_KEY=                      # DeepSeek direct (failover)
GEMINI_API_KEY=                        # Google Gemini
OPENAI_API_KEY=                        # OpenAI
ANTHROPIC_API_KEY=                     # Anthropic Claude

# ─── Telegram ────────────────────────────────────────────────────
TELEGRAM_BOT_TOKEN=                    # REQUIRED: 텔레그램 봇 토큰
TELEGRAM_CHAT_ID=                      # REQUIRED: 알림 채팅방 ID

# ─── Risk Management ────────────────────────────────────────────
RISK_MAX_PORTFOLIO_SIZE=10             # 최대 보유 종목 수
RISK_MAX_SECTOR_STOCKS=3              # 섹터당 최대 종목 수 (고정 fallback)
RISK_PORTFOLIO_GUARD_ENABLED=true
RISK_DYNAMIC_SECTOR_BUDGET_ENABLED=true
# 국면별 현금 하한선 (%)
RISK_CASH_FLOOR_STRONG_BULL_PCT=5.0
RISK_CASH_FLOOR_BULL_PCT=10.0
RISK_CASH_FLOOR_SIDEWAYS_PCT=15.0
RISK_CASH_FLOOR_BEAR_PCT=25.0
# 매매 제한
RISK_MAX_BUY_COUNT_PER_DAY=6
RISK_MAX_POSITION_VALUE_PCT=10.0       # 종목당 최대 비중 (%)
RISK_STOPLOSS_COOLDOWN_DAYS=3

# ─── Scoring ─────────────────────────────────────────────────────
SCORING_QUANT_SCORER_VERSION=v2        # v1 | v2 (잠재력 기반)
SCORING_UNIFIED_ANALYST_ENABLED=true   # Unified Analyst Pipeline
SCORING_LLM_CLAMP_RANGE=15            # ±15pt 가드레일
SCORING_HARD_FLOOR_SCORE=40.0         # 이하 → BLOCKED

# ─── Scanner ─────────────────────────────────────────────────────
SCANNER_MIN_REQUIRED_BARS=20
SCANNER_SIGNAL_COOLDOWN_SECONDS=600
SCANNER_RSI_GUARD_MAX=75.0
SCANNER_VOLUME_RATIO_WARNING=2.0
SCANNER_VWAP_DEVIATION_WARNING=0.02
SCANNER_NO_TRADE_WINDOW_START=09:00
SCANNER_NO_TRADE_WINDOW_END=09:15
SCANNER_DANGER_ZONE_START=14:00
SCANNER_DANGER_ZONE_END=15:00
# Conviction Entry (선제 진입)
SCANNER_CONVICTION_ENTRY_ENABLED=true
SCANNER_CONVICTION_MIN_HYBRID_SCORE=70.0
SCANNER_CONVICTION_MIN_LLM_SCORE=72.0
SCANNER_CONVICTION_MAX_GAIN_PCT=3.0
SCANNER_CONVICTION_WINDOW_START=09:15
SCANNER_CONVICTION_WINDOW_END=10:30
# Momentum (지정가 주문)
SCANNER_MOMENTUM_LIMIT_ORDER_ENABLED=true
SCANNER_MOMENTUM_LIMIT_PREMIUM=0.003
SCANNER_MOMENTUM_LIMIT_TIMEOUT_SEC=10
SCANNER_MOMENTUM_CONFIRMATION_BARS=1
SCANNER_MOMENTUM_MAX_GAIN_PCT=7.0

# ─── Scout ───────────────────────────────────────────────────────
SCOUT_MAX_WATCHLIST_SIZE=20
SCOUT_UNIVERSE_SIZE=200
SCOUT_ENABLE_NEWS_ANALYSIS=true

# ─── Selling ─────────────────────────────────────────────────────
SELL_RSI_OVERBOUGHT_THRESHOLD=75.0
SELL_TRAILING_ENABLED=true
SELL_TRAILING_ACTIVATION_PCT=5.0
SELL_TRAILING_ATR_MULT=1.5
SELL_PROFIT_TARGET_PCT=8.0
SELL_STOP_LOSS_PCT=5.0
SELL_TIME_EXIT_BULL_DAYS=20
SELL_TIME_EXIT_SIDEWAYS_DAYS=35

# ─── Signal Parameters ──────────────────────────────────────────
SIGNAL_GOLDEN_CROSS_SHORT=5
SIGNAL_GOLDEN_CROSS_LONG=20
SIGNAL_RSI_OVERSOLD=30
SIGNAL_RSI_OVERSOLD_BULL=40

# ─── Infrastructure ─────────────────────────────────────────────
QDRANT_HOST=localhost
QDRANT_PORT=6333
DART_API_KEY=                          # DART 공시 API 키 (optional)
